<!DOCTYPE html>
<html lang="en">
<head>
		<title>Lucas' Refuge &mdash; Go’s Generators</title>
		<meta charset="utf-8" />
        <link rel="icon" type="image/png" href="http://x8lucas8x.com/theme/images/favicon.png">
		<link rel="profile" href="http://gmpg.org/xfn/11" />
		<link rel="stylesheet" type="text/css" href="http://x8lucas8x.com/theme/css/style.css" />
		<link rel='stylesheet' id='oswald-css'  href='http://fonts.googleapis.com/css?family=Oswald&#038;ver=3.3.2' type='text/css' media='all' />
		<style type="text/css">
			body.custom-background { background-color: #000; }
		</style>
		<link rel="alternate" type="application/atom+xml"
			title="Lucas' Refuge — Flux Atom"
			href="http://x8lucas8x.com/" /> 
		<!--[if lte IE 8]><script src="http://x8lucas8x.com/theme/js/html5shiv.js"></script><![endif]-->
</head>
<body class="home blog custom-background " >
	<div id="container">
		<div id="header">
				<h1 id="site-title"><a href="http://x8lucas8x.com">Lucas' Refuge</a></h1>
<h2 id="site-description">We copyleft</h2>		</div><!-- /#banner -->
		<div id="menu">
			<div class="menu-navigation-container">
				<ul id="menu-navigation" class="menu">
						<li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://x8lucas8x.com/pages/contact.html">Contact</a></li>
						<li class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://x8lucas8x.com/category/blog.html">Blog</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://x8lucas8x.com/tags.html">Tags</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://x8lucas8x.com/archives.html">Archive</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://github.com/x8lucas8x">GitHub</a></li>
						<li  class="active" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://br.linkedin.com/in/x8lucas8x/en">LinkedIn</a></li>
				</ul>
			</div> <!--/#menu-navigation-container-->
		</div><!-- /#menu -->
		
		<div class="page-title">
		</div>
	
		<div id="contents">
<div class="post type-post status-publish format-standard hentry category-general" id="post">
	<div class="entry-meta">
        <div class="date">
            <a href="http://x8lucas8x.com/go-generators.html">Tuesday 08
September<br>2015</a>
        </div>
		<span class="byline">By <a href="http://x8lucas8x.com/author/x8lucas8x.html">x8lucas8x</a></span>
			<div class="comments"><a href="http://x8lucas8x.com/go-generators.html#disqus_thread" title="Comment on Go’s Generators">comments</a></div>
			<span class="cat-links"><a href="http://x8lucas8x.com/category/blog.html" title="View all posts in Blog" rel="category tag">Blog</a></span>
	</div> <!-- /#entry-meta -->
	<div class="main">
		<h2 class="entry-title">
			<a href="http://x8lucas8x.com/go-generators.html" title="Permalink to Go’s Generators" rel="bookmark">Go&#8217;s&nbsp;Generators</a>
		</h2>
		<div class="entry-content">

    <p>One of the amazing things about Python is that once you embody the so called &#8220;Zen of Python&#8221;,
no matter which language you are using, the same philosophy will prevail. So, in order to
contextualise a bit, I will briefly describe a recent quest of mine when trying to learn
the Go Language. More especifically, this post will dwell on the implementation of lazy list
evaluation, the equivalent of Python&#8217;s generators, in the Go&nbsp;language.</p>
    <p>Among Python&#8217;s many superpowers, generators is clearly a major one. Brought from
functional languages, like Haskell, which have demonstrated how better being lazy
is in terms of speed and memory management. Especially when collections&#8217; size
can grow&nbsp;indefinitely.</p>
<p>In Python, besides list comprehension, there are also the less known dictionary and
generator comprehensions. Being the later, what we are interested in the scope of
this post. So, considering we want to print all the multiples of 2 up to a certain
number y, we&nbsp;could:</p>
<div class="highlight"><pre><span class="n">multiples_of_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">multiples_of_2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>Alternatively, one could use the yield&nbsp;operator:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">multiples_of_2</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">x</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">multiples_of_2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>In Go, we do not have the same constructs, but we can employ Go&#8217;s channels to end
with a very similar&nbsp;effect:</p>
<div class="highlight"><pre><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">multiples_of_2</span><span class="p">(</span><span class="nx">c</span> <span class="kd">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">x</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">x</span> <span class="p">&lt;</span> <span class="nx">y</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span> <span class="p">{</span>
        <span class="nx">c</span> <span class="o">&lt;-</span> <span class="nx">x</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>
    <span class="k">defer</span> <span class="nb">close</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">multiples_of_2</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">x</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">c</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Of course the multiples_of_2&#8217;s interface expose a lot about the business logic of
our custom generator. Besides that, the whole process of initialising/closing a
channel is quite repetitive. And as the <span class="caps">DRY</span> principles preaches, repetition is the
root of all evil. But fear not, that required channel can be encapsulated inside
multiples_of_2, leading to an interface that very similar to the Python&nbsp;one.</p>
<div class="highlight"><pre><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&quot;fmt&quot;</span>

<span class="kd">func</span> <span class="nx">multiples_of_2</span><span class="p">(</span><span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>

    <span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">defer</span> <span class="nb">close</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
        <span class="k">for</span> <span class="nx">x</span> <span class="o">:=</span> <span class="mi">0</span> <span class="p">;</span> <span class="nx">x</span> <span class="p">&lt;</span> <span class="nx">y</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span> <span class="p">{</span>
            <span class="nx">c</span> <span class="o">&lt;-</span> <span class="nx">x</span>
        <span class="p">}</span>
    <span class="p">}()</span>

    <span class="k">return</span> <span class="nx">c</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">x</span><span class="o">:=</span> <span class="k">range</span> <span class="nx">multiples_of_2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>So, that is all. At the expense of some extra work, we can provide very pythonic
interfaces for lazy evaluated lists in&nbsp;Go.</p>

		</div> <!--/#entry-content-->
    		<span class="tag-links">
                <br>
                <strong>Tagged</strong>
 <a href="http://x8lucas8x.com/tag/generators.html" rel="tag">generators</a>,  <a href="http://x8lucas8x.com/tag/go.html" rel="tag">go</a>,  <a href="http://x8lucas8x.com/tag/python.html" rel="tag">python</a>,  <a href="http://x8lucas8x.com/tag/zen.html" rel="tag">zen</a>    		</span>
	</div> <!--/#main-->
</div>  <!--/#post-->


<br/>
<div id="comments">
	<div id="respond">
		<div id="disqus_thread"></div>
		<script type="text/javascript">
	            var disqus_shortname = 'lucasrefuge';
	
	            /* * * DON'T EDIT BELOW THIS LINE * * */
	            (function() {
	                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
	                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	            })();
	        </script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div><!-- #respond -->
</div><!-- #comments -->


		</div>
		
		<div id="footer">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/>
            </a><br><br>
				<script type="text/javascript">
					var _gaq = _gaq || [];
					_gaq.push(['_setAccount', 'UA-66386613-1']);
					_gaq.push(['_trackPageview']);
					(function() {
						var ga = document.createElement('script'); 
						ga.type = 'text/javascript'; ga.async = true;
						ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
						var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
					})();
				</script>
<script type="text/javascript">
    var disqus_shortname = 'lucasrefuge';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Lucas' Refuge
            </span> by <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName">Lucas Lira Gomes</span> is licensed under a 
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.

			<p>
            Powered by <a href="http://getpelican.com">Pelican</a>, theme by <a href="#">x8lucas8x</a>.
            </p>
		</div><!-- /#footer -->
	</div><!-- /#container -->
	<div style="display:none"></div>
</body>
</html>